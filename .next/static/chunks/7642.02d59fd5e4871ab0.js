"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7642],{7642:function(t,i,e){e.r(i),e.d(i,{HLSProvider:function(){return o}});var s=e(1001),a=e(2938);e(2265);let l=t=>(0,s.m)(t);class h{get instance(){return this.d}setup(t){let{streamType:i}=this.b.$state,e=(0,s.p)(i).includes("live"),l=(0,s.p)(i).includes("ll-");this.d=new t({lowLatencyMode:l,backBufferLength:l?4:e?8:void 0,renderTextTracksNatively:!1,...this.sb});let h=this.Pi.bind(this);for(let i of Object.values(t.Events))this.d.on(i,h);for(let i of(this.d.on(t.Events.ERROR,this.R.bind(this)),this.tb))i(this.d);this.b.player.dispatch("hls-instance",{detail:this.d}),this.d.attachMedia(this.m),this.d.on(t.Events.FRAG_LOADING,this.Qi.bind(this)),this.d.on(t.Events.AUDIO_TRACK_SWITCHED,this.Ri.bind(this)),this.d.on(t.Events.LEVEL_SWITCHED,this.Si.bind(this)),this.d.on(t.Events.LEVEL_LOADED,this.Ti.bind(this)),this.d.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.Ui.bind(this)),this.d.on(t.Events.CUES_PARSED,this.Vi.bind(this)),this.b.qualities[a.Q.Ja]=this.ke.bind(this),(0,s.l)(this.b.qualities,"change",this.le.bind(this)),(0,s.l)(this.b.audioTracks,"change",this.me.bind(this)),this.rb=(0,s.e)(this.ne.bind(this))}ba(t,i){return new s.D(l(t),{detail:i})}ne(){if(!this.b.$state.live())return;let t=new a.R(this.oe.bind(this));return t.Ya(),t.aa.bind(t)}oe(){var t,i;this.b.$state.liveSyncPosition.set(null!==(i=null===(t=this.d)||void 0===t?void 0:t.liveSyncPosition)&&void 0!==i?i:1/0)}Pi(t,i){var e;null===(e=this.b.player)||void 0===e||e.dispatch(this.ba(t,i))}Ui(t,i){let e=this.ba(t,i),s=-1;for(let t=0;t<i.tracks.length;t++){var l;let h=i.tracks[t],n=null!==(l=h.subtitleTrack)&&void 0!==l?l:h.closedCaptions,r=new a.b({id:"hls-".concat(h.kind,"-").concat(t),src:null==n?void 0:n.url,label:h.label,language:null==n?void 0:n.lang,kind:h.kind,default:h.default});r[a.i.na]=2,r[a.i.ib]=()=>{"showing"===r.mode?(this.d.subtitleTrack=t,s=t):s===t&&(this.d.subtitleTrack=-1,s=-1)},this.b.textTracks.add(r,e)}}Vi(t,i){var e;let s=null===(e=this.d)||void 0===e?void 0:e.subtitleTrack,a=this.b.textTracks.getById("hls-".concat(i.type,"-").concat(s));if(!a)return;let l=this.ba(t,i);for(let t of i.cues)t.positionAlign="auto",a.addCue(t,l)}Ri(t,i){let e=this.b.audioTracks[i.id];if(e){let s=this.ba(t,i);this.b.audioTracks[a.L.fa](e,!0,s)}}Si(t,i){let e=this.b.qualities[i.level];if(e){let s=this.ba(t,i);this.b.qualities[a.L.fa](e,!0,s)}}Ti(t,i){if(this.b.$state.canPlay())return;let{type:e,live:l,totalduration:h,targetduration:n}=i.details,r=this.ba(t,i);this.b.delegate.c("stream-type-change",l?"EVENT"===e&&Number.isFinite(h)&&n>=10?"live:dvr":"live":"on-demand",r),this.b.delegate.c("duration-change",h,r);let d=this.d.media;for(let t of(-1===this.d.currentLevel&&this.b.qualities[a.Q.Xa](!0,r),this.d.audioTracks)){let i={id:t.id.toString(),label:t.name,language:t.lang||"",kind:"main"};this.b.audioTracks[a.L.ea](i,r)}for(let t of this.d.levels){var o,c;let i={id:null!==(c=null===(o=t.id)||void 0===o?void 0:o.toString())&&void 0!==c?c:t.height+"p",width:t.width,height:t.height,codec:t.codecSet,bitrate:t.bitrate};this.b.qualities[a.L.ea](i,r)}d.dispatchEvent(new s.D("canplay",{trigger:r}))}R(t,i){if(i.fatal)switch(i.type){case"networkError":this.qe(i.error);break;case"mediaError":var e;null===(e=this.d)||void 0===e||e.recoverMediaError();break;default:this.rc(i.error)}}Qi(){this.oa>=0&&this.$a()}qe(t){var i;this.$a(),null===(i=this.d)||void 0===i||i.startLoad(),this.oa=window.setTimeout(()=>{this.oa=-1,this.rc(t)},5e3)}$a(){clearTimeout(this.oa),this.oa=-1}rc(t){this.b.delegate.c("error",{message:t.message,code:1,error:t})}ke(){this.d&&(this.d.currentLevel=-1)}le(){let{qualities:t}=this.b;this.d&&!t.auto&&(this.d[t.switch+"Level"]=t.selectedIndex,a.d&&(this.m.currentTime=this.m.currentTime))}me(){let{audioTracks:t}=this.b;this.d&&this.d.audioTrack!==t.selectedIndex&&(this.d.audioTrack=t.selectedIndex)}Wi(t){var i;this.$a(),(0,s.i)(t.src)&&(null===(i=this.d)||void 0===i||i.loadSource(t.src))}Xi(){var t,i;this.$a(),null===(t=this.d)||void 0===t||t.destroy(),this.d=null,null===(i=this.rb)||void 0===i||i.call(this),this.rb=null}constructor(t,i){this.m=t,this.b=i,this.d=null,this.rb=null,this.sb={},this.tb=new Set,this.oa=-1}}class n{async re(){let t={onLoadStart:this.Na.bind(this),onLoaded:this.ub.bind(this),onLoadError:this.se.bind(this)},i=await d(this.M,t);return((0,s.n)(i)&&!(0,s.i)(this.M)&&(i=await r(this.M,t)),i)?i.isSupported()?i:(this.b.player.dispatch(new s.D("hls-unsupported")),this.b.delegate.c("error",{message:"[vidstack] `hls.js` is not supported in this environment",code:4}),null):null}Na(){this.b.player.dispatch(new s.D("hls-lib-load-start"))}ub(t){this.b.player.dispatch(new s.D("hls-lib-loaded",{detail:t})),this.Ma(t)}se(t){let i=(0,a.j)(t);this.b.player.dispatch(new s.D("hls-lib-load-error",{detail:i})),this.b.delegate.c("error",{message:i.message,code:4,error:i})}constructor(t,i,e){this.M=t,this.b=i,this.Ma=e,this.re()}}async function r(t){var i,e,a,l,h;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,s.n)(t)){if(null===(i=n.onLoadStart)||void 0===i||i.call(n),t.prototype&&t.prototype!==Function)return null===(e=n.onLoaded)||void 0===e||e.call(n,t),t;try{let i=null===(a=await t())||void 0===a?void 0:a.default;if(i&&i.isSupported)null===(l=n.onLoaded)||void 0===l||l.call(n,i);else throw Error("");return i}catch(t){null===(h=n.onLoadError)||void 0===h||h.call(n,t)}}}async function d(t){var i,e,l;let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,s.i)(t)){null===(i=h.onLoadStart)||void 0===i||i.call(h);try{if(await (0,a.g)(t),!(0,s.o)(window.Hls))throw Error("");let i=window.Hls;return null===(e=h.onLoaded)||void 0===e||e.call(h,i),i}catch(t){null===(l=h.onLoadError)||void 0===l||l.call(h,t)}}}class o extends a.V{get ctor(){return this.sc}get instance(){return this.e.instance}get type(){return"hls"}get canLiveSync(){return!0}get config(){return this.e.sb}set config(t){this.e.sb=t}get library(){return this.pa}set library(t){this.pa=t}preconnect(){(0,s.i)(this.pa)&&(0,a.p)(this.pa)}setup(){super.setup(),new n(this.pa,this.b,t=>{this.sc=t,this.e.setup(t),this.b.delegate.c("provider-setup",this);let i=(0,s.p)(this.b.$state.source);i&&this.loadSource(i)})}async loadSource(t,i){if(!(0,s.i)(t.src)){this.pc();return}this.a.preload=i||"",this.he(t,"application/x-mpegurl"),this.e.Wi(t),this.L=t}onInstance(t){let i=this.e.instance;return i&&t(i),this.e.tb.add(t),()=>this.e.tb.delete(t)}destroy(){this.e.Xi()}constructor(){super(...arguments),this.$$PROVIDER_TYPE="HLS",this.sc=null,this.e=new h(this.video,this.b),this.pa="".concat("https://cdn.jsdelivr.net","/npm/hls.js@^1.5.0/dist/hls",".min.js")}}o.supported=(0,a.k)()}}]);